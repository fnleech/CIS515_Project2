%% Haar function
% The function takes in the vector u and computes the haar transform of a
% vector using averging and differencing 

function [haar_coeff] =haar(u)

[~, rows] = size(u); 

%Get number of iterations
n = log2(rows);

%Initial c_old and c_new
c_new = u; 
c_old = c_new; 

%loop through u_j vectors first and then 
% through i elements in u_j
for j = n:-1:0
    for i = 1:(2^j)
    c_old(i) = (c_new((2*i)-1) + c_new(2*i))/2; 
    c_old(2^j+i) = (c_new((2*i)-1) - c_new(2*i))/2;
    end
    
    c_new = c_old; 
        
end 
haar_coeff = c_new; 
end 



% function [haar_coeff] =haar(u

% 
% haar_coeff = []; 
% [~, m] = size(u); 
% 
% %number of rounds of differencing 
% n = m/2;
% 
% for h = 1:n-1
%     a = 1; % Index for average
%     c = []; 
%     d = [];
%     [~, m] = size(u);
%     for i = 1:2:m-1;
%         %average
%         c(a) = (u(i) + u(i+1))/2;
%         %difference 
%         d(a) = (u(i) - u(i+1))/2;
%         a = a + 1; 
%     end 
%     
%     if h == n-1;
%     haar_coeff = [c d haar_coeff];   
%     else 
%     haar_coeff = [d haar_coeff]; 
%     end 
%     
%     u = [c]; 
% end 
% end 