%% Haar Inverse 
% the reconstruction of a vector from its Haar coefficients
% function vector = haar_inv(haar_coeff)
% 
% [~, m] = size(haar_coeff); 
% 
% %number of rounds of differencing 
% n = m/2; 
% b_old = 1; 
% vector = zeros(1,m); 
% for h = 1:n-1 
%     a = 1; % Transformation index
%     c = []; 
%     d = []; 
%     
%     %Number of coeff to take out
%     b_new = 2 * b_old;  
%     haar_new = haar_coeff(1:b_new); 
%     iter = b_new/2;
%     
%     for i = 1:iter; 
%         %add
%         c = (haar_new(i) + haar_new(i+(b_new-b_old)));
%         haar_coeff(i+(iter-1)) = c;
%         
%         %substract
%         d = (haar_new(i) - haar_new(i+(b_new-b_old)));
%         haar_coeff(i+1) = d;
%         
%     end 
%     
%     b_old = b_new; 
%    
% end 
% end 


function u = haar_inv(haar_coeff)
[~, rows] = size(haar_coeff); 
n = log2(rows);
u_old = haar_coeff;
u_new = u_old; 
for j = 0:n-1
    for i = 1:(2^j)
    u_new(2*i-1) = u_old(i) + u_old(2^j + i); 
    u_new(2*i) = u_old(i) - u_old(2^j + i);
    end
    u_old = u_new; 
end 
u = haar_coeff; 
end 


